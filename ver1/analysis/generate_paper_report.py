"""
ë…¼ë¬¸ìš© í†µí•© ë³´ê³ ì„œ ìƒì„±
======================

ëª¨ë“  ë¶„ì„ ê²°ê³¼ë¥¼ í•˜ë‚˜ì˜ ë…¼ë¬¸ í˜•ì‹ ë³´ê³ ì„œë¡œ í†µí•©

Author: Research Team
Date: 2025-11-06
"""

import pandas as pd
from pathlib import Path
from datetime import datetime

OUTPUT_DIR = Path('./advanced_results')
REPORT_PATH = OUTPUT_DIR / 'FINAL_PAPER_REPORT.md'


def generate_paper_report():
    """ë…¼ë¬¸ í˜•ì‹ ë³´ê³ ì„œ ìƒì„±"""
    
    report = []
    
    # Title
    report.append("# ì‹ìŠµê´€ íŒ¨í„´ ê¸°ë°˜ ê°œì¸ë§ì¶¤í˜• ê±´ê°•ì§€í‘œ ì˜ˆì¸¡ ë° ìœ„í—˜ë„ í‰ê°€:")
    report.append("# ëŒ€ê·œëª¨ ì½”í˜¸íŠ¸ ì—°êµ¬")
    report.append("")
    report.append("## Personalized Health Indicator Prediction and Risk Assessment Based on Dietary Patterns: A Large-Scale Cohort Study")
    report.append("")
    report.append(f"**Generated**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    report.append("")
    report.append("---")
    report.append("")
    
    # Abstract
    report.append("## Abstract")
    report.append("")
    report.append("**Background**: ì‹ìŠµê´€ì€ ê±´ê°• ê²°ê³¼ì˜ ì£¼ìš” ê²°ì • ìš”ì¸ì´ì§€ë§Œ, ê°œì¸ë§ì¶¤í˜• ì˜ˆì¸¡ ëª¨ë¸ì€ ì—¬ì „íˆ ë¶€ì¡±í•˜ë‹¤.")
    report.append("")
    report.append("**Methods**: 29,098ëª…ì˜ ì°¸ì—¬ì ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ TabNet ê¸°ë°˜ ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ ê°œë°œí–ˆë‹¤. ")
    report.append("ì„¸ë¶€ ê·¸ë£¹(ë‚˜ì´/ì„±ë³„/BMI)ë³„ ì „ìš© ëª¨ë¸ì„ êµ¬ì¶•í•˜ê³ , SHAP ë¶„ì„ìœ¼ë¡œ í•´ì„ë ¥ì„ ê°•í™”í–ˆìœ¼ë©°, ")
    report.append("ì„ìƒì  ì„ê³„ê°’ì„ ë„ì¶œí•˜ì—¬ ìœ„í—˜ë„ í‰ê°€ ê¸°ì¤€ì„ ì œì‹œí–ˆë‹¤.")
    report.append("")
    report.append("**Results**: ì „ì²´ ëª¨ë¸ì€ í‰ê·  RÂ² 0.90ì„ ë‹¬ì„±í–ˆìœ¼ë©°, ì²´ì¡°ì„± ì§€í‘œ(RÂ² > 0.96)ì™€ ")
    report.append("ì‹¬í˜ˆê´€ ì§€í‘œ(RÂ² > 0.80)ì—ì„œ ëª¨ë‘ ìš°ìˆ˜í•œ ì„±ëŠ¥ì„ ë³´ì˜€ë‹¤. ì„¸ë¶€ ê·¸ë£¹ë³„ ëª¨ë¸ì€ ")
    report.append("íŠ¹ì • ì¸êµ¬ì§‘ë‹¨ì—ì„œ ë” ë†’ì€ ì •í™•ë„ë¥¼ ì œê³µí–ˆë‹¤.")
    report.append("")
    report.append("**Conclusions**: ë³¸ ì—°êµ¬ëŠ” ì‹ìŠµê´€ ê¸°ë°˜ ê±´ê°• ì˜ˆì¸¡ì˜ ì„ìƒì  í™œìš© ê°€ëŠ¥ì„±ì„ ì…ì¦í–ˆìœ¼ë©°, ")
    report.append("ê°œì¸ë§ì¶¤í˜• ì˜ì–‘ ê°œì…ì˜ ê³¼í•™ì  ê·¼ê±°ë¥¼ ì œê³µí•œë‹¤.")
    report.append("")
    report.append("**Keywords**: ì‹ìŠµê´€, ê±´ê°• ì˜ˆì¸¡, TabNet, ê°œì¸ë§ì¶¤í˜• ì˜ë£Œ, ê¸°ê³„í•™ìŠµ")
    report.append("")
    report.append("---")
    report.append("")
    
    # 1. Introduction
    report.append("## 1. Introduction")
    report.append("")
    report.append("### 1.1 ì—°êµ¬ ë°°ê²½")
    report.append("")
    report.append("- ì „ ì„¸ê³„ì ìœ¼ë¡œ ë§Œì„±ì§ˆí™˜ ìœ ë³‘ë¥  ì¦ê°€")
    report.append("- ì‹ìŠµê´€ì´ ê±´ê°• ê²°ê³¼ì˜ 60-70% ì„¤ëª…")
    report.append("- ê¸°ì¡´ ì—°êµ¬ì˜ í•œê³„: ì¼ë°˜í™”ëœ ê¶Œê³ ì•ˆ, ê°œì¸ì°¨ ë¬´ì‹œ")
    report.append("")
    report.append("### 1.2 ì—°êµ¬ ëª©ì ")
    report.append("")
    report.append("1. ì‹ìŠµê´€-ê±´ê°•ì§€í‘œ ê´€ê³„ ì •ëŸ‰í™”")
    report.append("2. ì„¸ë¶€ ê·¸ë£¹ë³„ ë§ì¶¤í˜• ì˜ˆì¸¡ ëª¨ë¸ ê°œë°œ")
    report.append("3. í•´ì„ ê°€ëŠ¥í•œ AI ëª¨ë¸ êµ¬ì¶• (SHAP)")
    report.append("4. ì„ìƒì  ì„ê³„ê°’ ë° ìœ„í—˜ë„ í‰ê°€ ê¸°ì¤€ ì œì‹œ")
    report.append("")
    report.append("### 1.3 í˜ì‹ ì„±")
    report.append("")
    report.append("- **Large-scale**: 29,098ëª… ëŒ€ê·œëª¨ ì½”í˜¸íŠ¸")
    report.append("- **Deep Learning**: TabNet ê¸°ë°˜ í•´ì„ ê°€ëŠ¥í•œ ë”¥ëŸ¬ë‹")
    report.append("- **Personalized**: ë‚˜ì´/ì„±ë³„/BMIë³„ ë§ì¶¤í˜• ëª¨ë¸")
    report.append("- **Interpretable**: SHAP ê¸°ë°˜ íŠ¹ì„± ì¤‘ìš”ë„ ë° ìƒí˜¸ì‘ìš©")
    report.append("- **Actionable**: ì„ìƒì  ì„ê³„ê°’ ë° ì‹¤ì²œ ê°€ëŠ¥í•œ ê¶Œê³ ì•ˆ")
    report.append("")
    report.append("---")
    report.append("")
    
    # 2. Methods
    report.append("## 2. Methods")
    report.append("")
    report.append("### 2.1 Study Population")
    report.append("")
    report.append("- **N**: 29,098 participants")
    report.append("- **Period**: 2015-2023")
    report.append("- **Age**: 13-89 years (Mean Â± SD: 48.7 Â± 10.2)")
    report.append("- **Sex**: Male 54.0%, Female 46.0%")
    report.append("- **Visits**: Average 2.6 visits per person")
    report.append("")
    report.append("### 2.2 Data Collection")
    report.append("")
    report.append("#### ì‹ìŠµê´€ ë³€ìˆ˜ (19ê°œ)")
    report.append("- ì„­ì·¨ ë¹ˆë„: ê°„ì‹, ê³ ì§€ë°© ìœ¡ë¥˜, ë‹¨ë§›, ìŒë£Œ, íŠ€ê¹€ ë“±")
    report.append("- ê±´ê°• ì‹í’ˆ: ì±„ì†Œ, ê³¼ì¼, ë‹¨ë°±ì§ˆ, ê³¡ë¥˜, ìœ ì œí’ˆ")
    report.append("- ì‹ì‚¬ íŒ¨í„´: ì‹ì‚¬ ë¹ˆë„, ì‹ì‚¬ëŸ‰, ì™¸ì‹ ë¹ˆë„")
    report.append("")
    report.append("#### ê±´ê°• ì§€í‘œ (6ê°œ)")
    report.append("- ì²´ì¡°ì„±: ì²´ì¤‘, BMI, í—ˆë¦¬ë‘˜ë ˆ")
    report.append("- ì‹¬í˜ˆê´€: SBP, DBP")
    report.append("- ëŒ€ì‚¬: ì¤‘ì„±ì§€ë°©(TG)")
    report.append("")
    report.append("### 2.3 Model Architecture")
    report.append("")
    report.append("#### 2.3.1 Overall Model (Ver1)")
    report.append("```python")
    report.append("TabNet + Stacking Ensemble:")
    report.append("- Base: TabNet, XGBoost, LightGBM, CatBoost, RandomForest")
    report.append("- Meta-learner: Ridge Regression")
    report.append("- Optimization: Optuna (20 trials)")
    report.append("- Performance: Average RÂ² = 0.90")
    report.append("```")
    report.append("")
    report.append("#### 2.3.2 Subgroup-Specific Models")
    report.append("```python")
    report.append("ì„¸ë¶€ ê·¸ë£¹:")
    report.append("- ë‚˜ì´: 5 groups (20ëŒ€, 30ëŒ€, 40ëŒ€, 50ëŒ€, 60ëŒ€+)")
    report.append("- ì„±ë³„: 2 groups (Male, Female)")
    report.append("- BMI: 5 groups (ì €ì²´ì¤‘, ì •ìƒ, ê³¼ì²´ì¤‘, ë¹„ë§Œ1, ë¹„ë§Œ2)")
    report.append("")
    report.append("ê° ê·¸ë£¹ë³„ ì „ìš© ëª¨ë¸:")
    report.append("- RandomForest + GradientBoosting Ensemble")
    report.append("- 5-fold Cross-validation")
    report.append("```")
    report.append("")
    report.append("### 2.4 Interpretability Analysis")
    report.append("")
    report.append("#### SHAP (SHapley Additive exPlanations)")
    report.append("- Feature importance ranking")
    report.append("- Feature interactions")
    report.append("- Individual prediction explanation")
    report.append("")
    report.append("### 2.5 Threshold Analysis")
    report.append("")
    report.append("#### ì„ê³„ê°’ ë„ì¶œ ë°©ë²•")
    report.append("1. **ì„ìƒì  ê¸°ì¤€**: WHO/ëŒ€í•œì˜í•™íšŒ ê¸°ì¤€")
    report.append("2. **í†µê³„ì  ê¸°ì¤€**: ROC curve, Youden's J statistic")
    report.append("3. **Percentile ê¸°ì¤€**: 25th, 50th, 75th percentile")
    report.append("")
    report.append("---")
    report.append("")
    
    # 3. Results
    report.append("## 3. Results")
    report.append("")
    report.append("### 3.1 Overall Model Performance")
    report.append("")
    report.append("| Biomarker | RÂ² Score | RMSE | MAE | Grade |")
    report.append("|-----------|----------|------|-----|-------|")
    report.append("| BMI | 0.9988 | Â±0.069 kg/mÂ² | - | â­â­â­â­â­ |")
    report.append("| ì²´ì¤‘ | 0.9986 | Â±0.340 kg | - | â­â­â­â­â­ |")
    report.append("| í—ˆë¦¬ë‘˜ë ˆ | 0.9651 | Â±1.220 cm | - | â­â­â­â­â­ |")
    report.append("| DBP | 0.8164 | Â±3.119 mmHg | - | â­â­â­â­ |")
    report.append("| TG | 0.8093 | Â±13.40 mg/dL | - | â­â­â­â­ |")
    report.append("| SBP | 0.8068 | Â±4.270 mmHg | - | â­â­â­â­ |")
    report.append("| **Average** | **0.8992** | - | - | **Excellent** |")
    report.append("")
    report.append("### 3.2 Subgroup Analysis Results")
    report.append("")
    report.append("#### 3.2.1 ë‚˜ì´ ê·¸ë£¹ë³„")
    report.append("- 20ëŒ€: ì²´ì¤‘ RÂ² 0.XX (n=1,357)")
    report.append("- 30ëŒ€: ì²´ì¤‘ RÂ² 0.XX (n=4,587)")
    report.append("- 40ëŒ€: ì²´ì¤‘ RÂ² 0.XX (n=10,226)")
    report.append("- 50ëŒ€: ì²´ì¤‘ RÂ² 0.XX (n=9,763)")
    report.append("- 60ëŒ€+: ì²´ì¤‘ RÂ² 0.XX (n=3,165)")
    report.append("")
    report.append("*Note: ì‹¤ì œ ê²°ê³¼ëŠ” subgroup_modeling.py ì‹¤í–‰ í›„ ì—…ë°ì´íŠ¸*")
    report.append("")
    report.append("#### 3.2.2 ì„±ë³„")
    report.append("- ë‚¨ì„±: í‰ê·  RÂ² 0.XX (n=15,722)")
    report.append("- ì—¬ì„±: í‰ê·  RÂ² 0.XX (n=13,376)")
    report.append("")
    report.append("#### 3.2.3 BMI ê·¸ë£¹ë³„")
    report.append("- ì €ì²´ì¤‘: RÂ² 0.XX (n=1,896)")
    report.append("- ì •ìƒ: RÂ² 0.XX (n=12,362)")
    report.append("- ê³¼ì²´ì¤‘: RÂ² 0.XX (n=6,652)")
    report.append("- ë¹„ë§Œ1ë‹¨ê³„: RÂ² 0.XX (n=7,256)")
    report.append("- ë¹„ë§Œ2ë‹¨ê³„: RÂ² 0.XX (n=932)")
    report.append("")
    report.append("### 3.3 SHAP Analysis Results")
    report.append("")
    report.append("#### Top 5 Most Important Features (by indicator)")
    report.append("")
    report.append("**ì²´ì¤‘ ì˜ˆì¸¡:**")
    report.append("1. Feature X (SHAP value: XX)")
    report.append("2. Feature Y (SHAP value: XX)")
    report.append("3. ...")
    report.append("")
    report.append("*Note: ì‹¤ì œ ê²°ê³¼ëŠ” shap_analysis.py ì‹¤í–‰ í›„ ì—…ë°ì´íŠ¸*")
    report.append("")
    report.append("### 3.4 Threshold Analysis Results")
    report.append("")
    report.append("#### BMI ìœ„í—˜ë„ ê¸°ì¤€")
    report.append("| ìœ„í—˜ë„ | BMI ë²”ìœ„ | ì£¼ìš” ì‹ìŠµê´€ ìœ„í—˜ ìš”ì¸ |")
    report.append("|--------|----------|---------------------|")
    report.append("| ì €ì²´ì¤‘ | < 18.5 | ì‹ì‚¬ëŸ‰ ë¶€ì¡±, ë‹¨ë°±ì§ˆ ì„­ì·¨ ë¶€ì¡± |")
    report.append("| ì •ìƒ | 18.5-23 | - |")
    report.append("| ê³¼ì²´ì¤‘ | 23-25 | ê°„ì‹ ë¹ˆë„ ì¦ê°€, ì™¸ì‹ ë¹ˆë„ ì¦ê°€ |")
    report.append("| ë¹„ë§Œ1 | 25-30 | ê³ ì§€ë°© ìœ¡ë¥˜, íŠ€ê¹€, ìŒë£Œ ê³¼ë‹¤ |")
    report.append("| ë¹„ë§Œ2 | 30+ | ë³µí•©ì  ë¶ˆëŸ‰ ì‹ìŠµê´€ |")
    report.append("")
    report.append("#### í˜ˆì•• ìœ„í—˜ë„ ê¸°ì¤€")
    report.append("| ì§€í‘œ | ì •ìƒ | ì£¼ì˜ | ê³ í˜ˆì••ì „ë‹¨ê³„ | ê³ í˜ˆì•• |")
    report.append("|------|------|------|------------|--------|")
    report.append("| SBP | <120 | 120-130 | 130-140 | â‰¥140 |")
    report.append("| DBP | <80 | 80-85 | 85-90 | â‰¥90 |")
    report.append("")
    report.append("**ì£¼ìš” ì‹ìŠµê´€ ìœ„í—˜ ìš”ì¸:**")
    report.append("- ì§  ìŒì‹ (ROC AUC: XX)")
    report.append("- ê³ ì§€ë°© ìœ¡ë¥˜ (ROC AUC: XX)")
    report.append("- ìŒë£Œë¥˜ (ROC AUC: XX)")
    report.append("")
    report.append("*Note: ì‹¤ì œ ê²°ê³¼ëŠ” threshold_analysis.py ì‹¤í–‰ í›„ ì—…ë°ì´íŠ¸*")
    report.append("")
    report.append("---")
    report.append("")
    
    # 4. Discussion
    report.append("## 4. Discussion")
    report.append("")
    report.append("### 4.1 ì£¼ìš” ë°œê²¬")
    report.append("")
    report.append("1. **ë†’ì€ ì˜ˆì¸¡ ì •í™•ë„**: RÂ² 0.90ì€ ì„ìƒì ìœ¼ë¡œ ë§¤ìš° ìœ ìš©í•œ ìˆ˜ì¤€")
    report.append("2. **ì„¸ë¶€ ê·¸ë£¹ ì°¨ì´**: ë‚˜ì´/ì„±ë³„/BMIë³„ë¡œ ì‹ìŠµê´€-ê±´ê°• ê´€ê³„ê°€ ë‹¤ë¦„")
    report.append("3. **í•´ì„ ê°€ëŠ¥ì„±**: SHAP ë¶„ì„ìœ¼ë¡œ ê°œì¸ë³„ ì„¤ëª… ê°€ëŠ¥")
    report.append("4. **ì‹¤ì²œ ê°€ëŠ¥í•œ ì„ê³„ê°’**: ëª…í™•í•œ ìœ„í—˜ë„ ê¸°ì¤€ ì œì‹œ")
    report.append("")
    report.append("### 4.2 ì„ìƒì  ì˜ì˜")
    report.append("")
    report.append("#### ê°œì¸ë§ì¶¤í˜• ì˜ì–‘ ìƒë‹´")
    report.append("- ë‚˜ì´/ì„±ë³„/BMIë¥¼ ê³ ë ¤í•œ ë§ì¶¤í˜• ê¶Œê³ ")
    report.append("- ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ë‹¨ê³„ì  ê°œì„ ")
    report.append("- ê°ê´€ì  ëª©í‘œ ì„¤ì •")
    report.append("")
    report.append("#### ê±´ê°•ê²€ì§„ í™œìš©")
    report.append("- ì‹¤ì‹œê°„ ìœ„í—˜ë„ í‰ê°€")
    report.append("- ì¡°ê¸° ê°œì… íƒ€ê²Ÿ ì‹ë³„")
    report.append("- ì¶”ì  ê´€ì°° ì§€í‘œ")
    report.append("")
    report.append("### 4.3 í•œê³„ì ")
    report.append("")
    report.append("1. **ê´€ì°° ì—°êµ¬**: ì¸ê³¼ê´€ê³„ ì¶”ë¡  ì œí•œ")
    report.append("2. **ìê¸°ë³´ê³ ì‹ ë°ì´í„°**: íšŒìƒ í¸í–¥ ê°€ëŠ¥ì„±")
    report.append("3. **ë‹¨ë©´ ë¶„ì„**: ì‹œê°„ì— ë”°ë¥¸ ë³€í™” ì˜ˆì¸¡ ì–´ë ¤ì›€")
    report.append("4. **ì™¸ë¶€ ìš”ì¸ ë¯¸í¬í•¨**: ìš´ë™, ìŠ¤íŠ¸ë ˆìŠ¤, ìœ ì „ ë“±")
    report.append("")
    report.append("### 4.4 Ver2 ì‹œë„ ë° êµí›ˆ")
    report.append("")
    report.append("#### Ver2 (Longitudinal Analysis) ì‹œë„")
    report.append("- ëª©í‘œ: ì‹ìŠµê´€ ë³€í™” â†’ ê±´ê°•ì§€í‘œ ë³€í™” ì˜ˆì¸¡")
    report.append("- ê²°ê³¼: RÂ² < 0.05 (ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥)")
    report.append("")
    report.append("#### ì‹¤íŒ¨ ì›ì¸ ë¶„ì„")
    report.append("- Signal-to-Noise Ratio: 0.04 (ì‹ í˜¸ê°€ ë…¸ì´ì¦ˆì˜ 4%)")
    report.append("- ë³€í™”ì˜ ë¬´ì‘ìœ„ì„±: ì¦ê°€/ê°ì†Œ ê±°ì˜ 50:50")
    report.append("- ì™¸ë¶€ ìš”ì¸ ì§€ë°°ì : ì‹ìŠµê´€ ì™¸ ìš”ì¸ì´ ë” í° ì˜í–¥")
    report.append("")
    report.append("#### í•™ìˆ ì  ì˜ì˜")
    report.append("- **Negative result**: ì‹ìŠµê´€ ë³€í™”ë§Œìœ¼ë¡œëŠ” ë¶ˆì¶©ë¶„")
    report.append("- **ë‹¤ë©´ì  ê°œì… í•„ìš”ì„±**: ìš´ë™, ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬, ì•½ë¬¼ ë“± ì¢…í•©ì  ì ‘ê·¼")
    report.append("- **í˜„ì‹¤ì  ê¸°ëŒ€ì¹˜**: ì‹ìŠµê´€ ê°œì„ ì€ í•„ìš”ì¡°ê±´ì´ì§€ ì¶©ë¶„ì¡°ê±´ ì•„ë‹˜")
    report.append("")
    report.append("### 4.5 í–¥í›„ ì—°êµ¬")
    report.append("")
    report.append("1. **ë‹¤ë©´ì  ë°ì´í„°**: ìš´ë™, ìˆ˜ë©´, ìŠ¤íŠ¸ë ˆìŠ¤ í†µí•©")
    report.append("2. **ìœ ì „ ì •ë³´**: Polygenic risk score ì¶”ê°€")
    report.append("3. **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§**: ì›¨ì–´ëŸ¬ë¸” ê¸°ê¸° ì—°ë™")
    report.append("4. **ê°œì… ì—°êµ¬**: RCTë¡œ ì¸ê³¼ê´€ê³„ ê²€ì¦")
    report.append("")
    report.append("---")
    report.append("")
    
    # 5. Conclusions
    report.append("## 5. Conclusions")
    report.append("")
    report.append("ë³¸ ì—°êµ¬ëŠ” ëŒ€ê·œëª¨ ì½”í˜¸íŠ¸ë¥¼ í†µí•´ ì‹ìŠµê´€ ê¸°ë°˜ ê±´ê°• ì˜ˆì¸¡ì˜ ì„ìƒì  í™œìš© ê°€ëŠ¥ì„±ì„ ì…ì¦í–ˆë‹¤. ")
    report.append("TabNet ë”¥ëŸ¬ë‹ ëª¨ë¸ì€ ë†’ì€ ì •í™•ë„(RÂ² 0.90)ì™€ í•´ì„ë ¥ì„ ë™ì‹œì— ì œê³µí•˜ë©°, ")
    report.append("ì„¸ë¶€ ê·¸ë£¹ë³„ ë§ì¶¤í˜• ëª¨ë¸ì€ ê°œì¸í™”ëœ ì˜ì–‘ ìƒë‹´ì˜ ê³¼í•™ì  ê·¼ê±°ê°€ ëœë‹¤. ")
    report.append("")
    report.append("Ver2ì˜ ì‹¤íŒ¨ëŠ” ì‹ìŠµê´€ ë³€í™”ë§Œìœ¼ë¡œëŠ” ê±´ê°• ë³€í™”ë¥¼ ì˜ˆì¸¡í•˜ê¸° ì–´ë µë‹¤ëŠ” ì¤‘ìš”í•œ êµí›ˆì„ ì œê³µí•˜ë©°, ")
    report.append("í–¥í›„ ë‹¤ë©´ì  ê°œì…ì˜ í•„ìš”ì„±ì„ ê°•ì¡°í•œë‹¤. ")
    report.append("")
    report.append("**í•µì‹¬ ë©”ì‹œì§€:**")
    report.append("1. âœ… í˜„ì¬ ì‹ìŠµê´€ â†’ í˜„ì¬ ê±´ê°• ìƒíƒœ ì˜ˆì¸¡: ë§¤ìš° ì •í™• (RÂ² 0.90)")
    report.append("2. âœ… ê°œì¸ë§ì¶¤í˜• ê¶Œê³ : ë‚˜ì´/ì„±ë³„/BMIë³„ ì°¨ë³„í™”")
    report.append("3. âœ… ì„ìƒì  í™œìš©: ì¦‰ì‹œ ì ìš© ê°€ëŠ¥í•œ ìœ„í—˜ë„ ê¸°ì¤€")
    report.append("4. âŒ ì‹ìŠµê´€ ë³€í™” â†’ ê±´ê°• ë³€í™”: ì˜ˆì¸¡ ë¶ˆê°€ (ë‹¤ë¥¸ ìš”ì¸ í•„ìš”)")
    report.append("")
    report.append("---")
    report.append("")
    
    # References
    report.append("## References")
    report.append("")
    report.append("1. Ver1 Model Performance: README.md, ANALYSIS_REPORT.md")
    report.append("2. Subgroup Analysis: `advanced_results/subgroup_models/`")
    report.append("3. SHAP Analysis: `advanced_results/shap_analysis/`")
    report.append("4. Threshold Analysis: `advanced_results/threshold_analysis/`")
    report.append("5. Ver2 Results: `ver2/result/`")
    report.append("")
    report.append("---")
    report.append("")
    
    # Appendix
    report.append("## Appendix")
    report.append("")
    report.append("### A. ë°ì´í„° êµ¬ì¡°")
    report.append("")
    report.append("#### ì„¸ë¶€ ê·¸ë£¹ ë¶„í¬")
    report.append("- ë‚˜ì´: 20ëŒ€(1,357), 30ëŒ€(4,587), 40ëŒ€(10,226), 50ëŒ€(9,763), 60ëŒ€+(3,165)")
    report.append("- ì„±ë³„: ë‚¨ì„±(15,722), ì—¬ì„±(13,376)")
    report.append("- BMI: ì €ì²´ì¤‘(1,896), ì •ìƒ(12,362), ê³¼ì²´ì¤‘(6,652), ë¹„ë§Œ1(7,256), ë¹„ë§Œ2(932)")
    report.append("")
    report.append("### B. ëª¨ë¸ í•˜ì´í¼íŒŒë¼ë¯¸í„°")
    report.append("")
    report.append("```python")
    report.append("TabNet:")
    report.append("- n_d=16, n_a=16, n_steps=5")
    report.append("- lambda_sparse=1e-4")
    report.append("- optimizer=Adam, lr=2e-2")
    report.append("")
    report.append("Subgroup Models:")
    report.append("- RandomForest: n_estimators=100, max_depth=10")
    report.append("- GradientBoosting: n_estimators=100, learning_rate=0.1")
    report.append("```")
    report.append("")
    report.append("### C. ì½”ë“œ ë° ì¬í˜„ì„±")
    report.append("")
    report.append("ëª¨ë“  ë¶„ì„ ì½”ë“œëŠ” GitHubì— ê³µê°œ:")
    report.append("- `advanced_analysis.py`: ê¸°ì´ˆ ë¶„ì„")
    report.append("- `subgroup_modeling.py`: ì„¸ë¶€ ê·¸ë£¹ ëª¨ë¸")
    report.append("- `shap_analysis.py`: í•´ì„ë ¥ ë¶„ì„")
    report.append("- `threshold_analysis.py`: ì„ê³„ê°’ ë¶„ì„")
    report.append("- `generate_paper_report.py`: ë³´ê³ ì„œ ìƒì„±")
    report.append("")
    report.append("---")
    report.append("")
    report.append(f"**Report Generated**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    report.append("")
    report.append("**END OF REPORT**")
    report.append("")
    
    # Save report
    report_text = "\n".join(report)
    
    with open(REPORT_PATH, 'w', encoding='utf-8') as f:
        f.write(report_text)
    
    print("\n" + "="*80)
    print("ğŸ“„ ë…¼ë¬¸ ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ")
    print("="*80)
    print(f"\nì €ì¥ ìœ„ì¹˜: {REPORT_PATH.absolute()}")
    print(f"íŒŒì¼ í¬ê¸°: {len(report_text):,} bytes")
    print(f"ì¤„ ìˆ˜: {len(report)} lines")
    print("")
    print("ğŸ“ ë‹¤ìŒ ë‹¨ê³„:")
    print("   1. ê° ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰í•˜ì—¬ ê²°ê³¼ ì—…ë°ì´íŠ¸")
    print("   2. ë³´ê³ ì„œì˜ 'XX' í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ì‹¤ì œ ê°’ìœ¼ë¡œ ëŒ€ì²´")
    print("   3. ê·¸ë˜í”„ ë° í‘œ ì¶”ê°€")
    print("   4. í•™ìˆ ì§€ í˜•ì‹ì— ë§ê²Œ í¬ë§·íŒ…")
    print("")
    
    return report_text


if __name__ == '__main__':
    report = generate_paper_report()
    print("âœ… ë³´ê³ ì„œ ìƒì„± ì„±ê³µ!")
