# Ver1 ëª¨ë¸ ë¡œì»¬ ì‹¤í–‰ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

ìƒŒë“œë°•ìŠ¤ í™˜ê²½ì—ì„œëŠ” ë©”ëª¨ë¦¬ ì œì•½ìœ¼ë¡œ Ver1 TabNet ëª¨ë¸ í•™ìŠµì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
ë¡œì»¬ ì»´í“¨í„°ì—ì„œ ì‹¤í–‰í•˜ì—¬ ëª¨ë¸ì„ ìƒì„±í•˜ê³  ê²°ê³¼ë¥¼ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.

---

## ğŸ”§ ì‚¬ì „ ì¤€ë¹„

### 1. ì €ì¥ì†Œ í´ë¡ 
```bash
git clone https://github.com/HeejeongH/HPEACE_prediction.git
cd HPEACE_prediction/ver1
```

### 2. í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
```bash
pip install pandas numpy scikit-learn
pip install xgboost lightgbm catboost
pip install torch pytorch-tabnet
pip install matplotlib seaborn
pip install openpyxl tqdm
pip install shap  # SHAP ë¶„ì„ìš© (ì„ íƒì‚¬í•­)
```

**ë˜ëŠ” requirements.txt ì‚¬ìš©:**
```bash
pip install -r requirements.txt
```

### 3. ë°ì´í„° í™•ì¸
- ë°ì´í„° ìœ„ì¹˜: `../data/total_again.xlsx`
- íŒŒì¼ í¬ê¸°: ì•½ 7.7MB
- ìƒ˜í”Œ ìˆ˜: 29,098ê°œ

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### Option 1: ì•ˆì „ ëª¨ë“œ (ì¶”ì²œ) â­

**ê°€ì¥ ì•ˆì •ì ì´ê³  ë¹ ë¥¸ ë°©ë²•**

```bash
python run_training.py safe
```

ë˜ëŠ”:
```bash
python run_training.py 1
```

**íŠ¹ì§•:**
- TabNet + Stacking Ensemble ì‚¬ìš©
- Optuna ìµœì í™” ì—†ìŒ (ì•ˆì •ì„± ìš°ì„ )
- ì˜ˆìƒ ì‹œê°„: 30-60ë¶„
- ë©”ëª¨ë¦¬ ì‚¬ìš©: 2-4GB

---

### Option 2: ì „ì²´ ìµœì í™” ëª¨ë“œ

**ìµœê³  ì„±ëŠ¥ì„ ì›í•˜ëŠ” ê²½ìš°**

```bash
python run_training.py full
```

**íŠ¹ì§•:**
- TabNet + Stacking + Optuna ìµœì í™”
- Optuna 20íšŒ ì‹œë„
- ì˜ˆìƒ ì‹œê°„: 1-2ì‹œê°„
- ë©”ëª¨ë¦¬ ì‚¬ìš©: 4-8GB
- âš ï¸ Optuna segfault ë°œìƒ ê°€ëŠ¥

---

### Option 3: ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ëª¨ë“œ

**ë™ì‘ í™•ì¸ìš©**

```bash
python run_training.py quick
```

**íŠ¹ì§•:**
- Optuna 5íšŒë§Œ ì‹œë„
- ì˜ˆìƒ ì‹œê°„: 20-30ë¶„
- ì„±ëŠ¥ì€ ì•ˆì „ ëª¨ë“œì™€ ìœ ì‚¬

---

## ğŸ“Š ì¶œë ¥ ê²°ê³¼

í•™ìŠµì´ ì™„ë£Œë˜ë©´ ë‹¤ìŒ ë””ë ‰í† ë¦¬ì— ê²°ê³¼ê°€ ì €ì¥ë©ë‹ˆë‹¤:

```
ver1/result/
â”œâ”€â”€ models/                          # í•™ìŠµëœ ëª¨ë¸ íŒŒì¼
â”‚   â”œâ”€â”€ ì²´ì¤‘_model.pkl
â”‚   â”œâ”€â”€ ì²´ì§ˆëŸ‰ì§€ìˆ˜_model.pkl
â”‚   â”œâ”€â”€ í—ˆë¦¬ë‘˜ë ˆ(WAIST)_model.pkl
â”‚   â”œâ”€â”€ SBP_model.pkl
â”‚   â”œâ”€â”€ DBP_model.pkl
â”‚   â””â”€â”€ TG_model.pkl
â”‚
â”œâ”€â”€ predictions/                     # ì˜ˆì¸¡ ê²°ê³¼
â”‚   â”œâ”€â”€ ì²´ì¤‘_predictions.csv
â”‚   â”œâ”€â”€ ì²´ì§ˆëŸ‰ì§€ìˆ˜_predictions.csv
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ feature_importance/              # íŠ¹ì„± ì¤‘ìš”ë„
â”‚   â”œâ”€â”€ ì²´ì¤‘_feature_importance.csv
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ performance/                     # ì„±ëŠ¥ ì§€í‘œ
    â””â”€â”€ overall_performance.csv      # RÂ², RMSE, MAE ë“±
```

---

## ğŸ“¤ ê²°ê³¼ ì—…ë¡œë“œ ë°©ë²•

### 1. ê²°ê³¼ ì••ì¶•
```bash
cd ver1
tar -czf ver1_results.tar.gz result/
```

### 2. GitHubì— ì—…ë¡œë“œ

**ë°©ë²• A: Git LFS ì‚¬ìš© (ëŒ€ìš©ëŸ‰ íŒŒì¼)**
```bash
# Git LFS ì„¤ì¹˜ (ì²˜ìŒë§Œ)
git lfs install
git lfs track "*.pkl"
git lfs track "*.tar.gz"

# ì»¤ë°‹ ë° í‘¸ì‹œ
git add result/
git commit -m "Add Ver1 trained models and results"
git push origin main
```

**ë°©ë²• B: ì••ì¶• íŒŒì¼ì„ GitHub Releaseì— ì—…ë¡œë“œ**
1. GitHub ì €ì¥ì†Œë¡œ ì´ë™
2. "Releases" â†’ "Create a new release"
3. `ver1_results.tar.gz` íŒŒì¼ ì²¨ë¶€
4. ë¦´ë¦¬ì¦ˆ ìƒì„±

**ë°©ë²• C: Google Drive ë§í¬ ê³µìœ **
1. `ver1_results.tar.gz`ë¥¼ Google Driveì— ì—…ë¡œë“œ
2. ê³µìœ  ë§í¬ë¥¼ ì´ìŠˆì— ì½”ë©˜íŠ¸ë¡œ ë‚¨ê¸°ê¸°

---

## ğŸ” ì‹¤í–‰ ì¤‘ í™•ì¸ì‚¬í•­

### ì§„í–‰ ìƒí™© í™•ì¸
```python
# ì½˜ì†” ì¶œë ¥ ì˜ˆì‹œ:
================================================================================
ğŸ¯ íƒ€ê²Ÿ: ì²´ì¤‘
================================================================================
   ğŸ“Š ì‚¬ìš© ê°€ëŠ¥í•œ ìƒ˜í”Œ: 29,098ê°œ
   ğŸ“Š ì‚¬ìš© íŠ¹ì„± ìˆ˜: 100ê°œ
   ğŸ“Š ì´ìƒì¹˜ ì œê±° í›„: 84,723ê°œ
   ğŸ“Š ì„ íƒëœ íŠ¹ì„±: 50ê°œ

   ğŸ”§ TabNet í†µí•© Stacking Ensemble êµ¬ì„± ì¤‘...
      ğŸ§  TabNet ë”¥ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµ ì¤‘...
      
Early stopping occurred at epoch 124 with best_epoch = 74 and best_val_0_rmse = 0.29674

      âœ… TabNet í•™ìŠµ ì™„ë£Œ
      ğŸ¯ ë‹¤ë¥¸ Base Models í•™ìŠµ ì¤‘...
         â–¸ XGBoost... ì™„ë£Œ
         â–¸ LightGBM... ì™„ë£Œ
         â–¸ CatBoost... ì™„ë£Œ
         â–¸ RandomForest... ì™„ë£Œ
      
      âœ… Stacking Ensemble ì™„ë£Œ
   
   ğŸ“ˆ ì„±ëŠ¥:
      Train RÂ²: 0.9634
      Test RÂ²: 0.9012
      RMSE: 2.85

================================================================================
âœ… ì²´ì¤‘ ëª¨ë¸ ì €ì¥: result/models/ì²´ì¤‘_model.pkl
================================================================================
```

### ì˜ˆìƒ ë¡œê·¸ íƒ€ì„ë¼ì¸

| ì‹œê°„ | ë‹¨ê³„ | ì„¤ëª… |
|------|------|------|
| 0-2ë¶„ | ë°ì´í„° ë¡œë“œ | Excel íŒŒì¼ ì½ê¸° ë° ì „ì²˜ë¦¬ |
| 2-5ë¶„ | íŠ¹ì„± ìƒì„± | EWMA ë° íŒŒìƒ íŠ¹ì„± ìƒì„± |
| 5-60ë¶„ | ëª¨ë¸ í•™ìŠµ | 6ê°œ ì§€í‘œ Ã— ê° 5-10ë¶„ |
| 60ë¶„+ | ê²°ê³¼ ì €ì¥ | ëª¨ë¸ ë° í‰ê°€ ê²°ê³¼ ì €ì¥ |

---

## âŒ ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: ë©”ëª¨ë¦¬ ë¶€ì¡± (MemoryError)
```bash
# í•´ê²°: TabNetë§Œ ì‚¬ìš© (Stacking ì—†ìŒ)
python run_training.py tabnet
```

### ë¬¸ì œ 2: Optuna segfault
```bash
# í•´ê²°: ì•ˆì „ ëª¨ë“œ ì‚¬ìš© (Optuna ë¹„í™œì„±í™”)
python run_training.py safe
```

### ë¬¸ì œ 3: CUDA/GPU ì—ëŸ¬
```python
# src/TABNET_ENHANCED_MODEL.py ì—ì„œ ìˆ˜ì •:
device_name = 'cpu'  # 'cuda' ëŒ€ì‹  'cpu' ì‚¬ìš©
```

### ë¬¸ì œ 4: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ì‹¤íŒ¨
```bash
# ìµœì†Œ ìš”êµ¬ì‚¬í•­ë§Œ ì„¤ì¹˜
pip install pandas numpy scikit-learn xgboost lightgbm torch pytorch-tabnet
```

---

## ğŸ“Š ì˜ˆìƒ ì„±ëŠ¥

ì•ˆì „ ëª¨ë“œë¡œ ì‹¤í–‰ ì‹œ ì˜ˆìƒ ì„±ëŠ¥:

| ê±´ê°•ì§€í‘œ | RÂ² | RMSE | MAE |
|---------|-----|------|-----|
| ì²´ì¤‘ | 0.90+ | 2.5-3.0 | 1.8-2.2 |
| ì²´ì§ˆëŸ‰ì§€ìˆ˜ | 0.92+ | 0.8-1.0 | 0.6-0.8 |
| í—ˆë¦¬ë‘˜ë ˆ | 0.88+ | 4.0-5.0 | 3.0-4.0 |
| SBP | 0.82+ | 8.0-10.0 | 6.0-8.0 |
| DBP | 0.80+ | 5.0-6.0 | 4.0-5.0 |
| TG | 0.78+ | 40-50 | 30-40 |

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„ (ëª¨ë¸ ìƒì„± í›„)

ëª¨ë¸ì´ ìƒì„±ë˜ë©´ ë‹¤ìŒ ë¶„ì„ì„ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

### 1. ì„œë¸Œê·¸ë£¹ ëª¨ë¸ë§ (Phase 3)
```bash
python subgroup_modeling.py
```
- ì˜ˆìƒ ì‹œê°„: 30-60ë¶„
- ì¶œë ¥: `advanced_results/subgroup_models/`

### 2. SHAP í•´ì„ì„± ë¶„ì„ (Phase 4)
```bash
python shap_analysis.py
```
- ì˜ˆìƒ ì‹œê°„: 30-60ë¶„
- ì¶œë ¥: `advanced_results/shap_analysis/`

### 3. ë…¼ë¬¸ ë³´ê³ ì„œ ì—…ë°ì´íŠ¸
```bash
python generate_paper_report.py
```
- ì‹¤ì œ ì„±ëŠ¥ ì§€í‘œë¡œ ë³´ê³ ì„œ ì—…ë°ì´íŠ¸

---

## ğŸ’¬ ë¬¸ì˜ ë° ì´ìŠˆ

ë¬¸ì œê°€ ë°œìƒí•˜ë©´:
1. ì—ëŸ¬ ë©”ì‹œì§€ ì „ì²´ ìº¡ì²˜
2. `python --version` ë° `pip list` ì¶œë ¥
3. GitHub Issuesì— ë³´ê³ 

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

ì‹¤í–‰ ì „ í™•ì¸ì‚¬í•­:

- [ ] Python 3.8+ ì„¤ì¹˜ë¨
- [ ] í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª¨ë‘ ì„¤ì¹˜ë¨
- [ ] `../data/total_again.xlsx` íŒŒì¼ ì¡´ì¬
- [ ] ìµœì†Œ 4GB ë©”ëª¨ë¦¬ ì—¬ìœ  ìˆìŒ
- [ ] 60ë¶„+ ì‹¤í–‰ ì‹œê°„ í™•ë³´

ì‹¤í–‰ í›„ í™•ì¸ì‚¬í•­:

- [ ] `result/models/` í´ë”ì— 6ê°œ `.pkl` íŒŒì¼ ìƒì„±
- [ ] `result/performance/overall_performance.csv` ì¡´ì¬
- [ ] ì½˜ì†”ì— "âœ… ëª¨ë“  ëª¨ë¸ í•™ìŠµ ì™„ë£Œ" ë©”ì‹œì§€ ì¶œë ¥
- [ ] ì••ì¶• íŒŒì¼ ìƒì„± ë° ì—…ë¡œë“œ ì™„ë£Œ

---

**í™”ì´íŒ…! ğŸ’ª**

ë¬¸ì œì—†ì´ ì‹¤í–‰ë˜ë©´ ì•½ 1ì‹œê°„ í›„ ì™„ë£Œë  ê²ƒì…ë‹ˆë‹¤.
ê²°ê³¼ê°€ ë‚˜ì˜¤ë©´ GitHub ë˜ëŠ” Driveì— ì—…ë¡œë“œí•´ì£¼ì„¸ìš”!
